<template>
  <div id="app">
    <van-nav-bar title="点餐" left-text="返回" left-arrow />
    <van-row type="flex" style="height: calc(100vh - 46px)">
      <van-sidebar v-model="activeMenu" type="flex">
        <van-sidebar-item title="特色菜" />
        <van-sidebar-item title="荤菜" />
        <van-sidebar-item title="素菜" />
        <van-sidebar-item title="汤" />
      </van-sidebar>
      <div
        style="
          width: calc(100vw - 80px);
          height: calc(100vh - 46px);
          overflow: scroll;
        "
      >
        <template v-for="(food, index) in foodList">
          <van-card
            :key="food.name"
            :num="food.quantity"
            :price="food.price"
            :desc="food.ingredient"
            :title="food.name"
            :thumb="food.pic"
            @click="showDetail(index)"
          >
          </van-card>
        </template>
      </div>
    </van-row>
    <van-popup
      v-model="showPopup"
      round
      position="bottom"
      :style="{ height: '55%' }"
      ><div style="padding-top: 28px; padding-left: 10px">
        <van-row>
          <van-col span="8">
            <img
              style="padding-left: 12px"
              width="90px"
              height="80px"
              :src="foodDetail.pic"
            />
          </van-col>
          <van-col span="16"
            >{{ foodDetail.name }}<br /><br />数量：<van-stepper
              style="position: fixed; right: 50px"
              min="0"
              v-model="foodDetail.quantity"
              @change="sum"
          /></van-col>
        </van-row>
        <van-divider />
        <div style="height:24vh; overflow-y: scroll">
          菜品详情：
          {{ foodDetail.detail }}
          <br /><br />
          食材/原料：{{ foodDetail.ingredient }} <br /><br />
          适用人群：{{ foodDetail.audience }}
        </div>
        <van-submit-bar
          button-text="加菜单"
          @submit="
            foodDetail.quantity += 1;
            showPopup = false;
          "
        />
      </div>
    </van-popup>
    <div
      style="
        position: fixed;
        width: 100%;
        bottom: 0px;
        height: 50px;
        background-color: white;
        z-index: 1;
        box-shadow: 0px -2px 5px grey;
      "
    >
      <van-icon
        size="2em"
        style="margin: 10px"
        name="shopping-cart"
        :badge="foodSum"
      ></van-icon>
      <p style="position: fixed; right: 35px; bottom: 8px; margin: 8px">
        合计：{{ priceSum }}元
      </p>
    </div>
  </div>
</template>

<style >
</style>

<script>
export default {
  data() {
    return {
      foodSum: 0,
      priceSum: 0,
      activeMenu: 0,
      showPopup: false,
      foodList: [
        {
          name: "红烧肉",
          detail:
            "其以五花肉为制作主料，最好选用肥瘦相间的三层肉（五花肉）来做，锅具以砂锅为主，做出来的肉肥瘦相间，香甜松软，营养丰富，入口即化。",
          quantity: 0,
          audience: "食肉人士",
          price: 19.9,
          ingredient: "猪肉",
          pic: "./hong.jpg",
        },
        {
          name: "回锅肉",
          detail:
            "是一种四川传统菜式中家常（味型）菜肴的代表菜肴之一，属于川菜系列。制作原料主要有猪后臀肉、青椒、蒜苗等，口味独特，色泽红亮，肥而不腻。",
          quantity: 0,
          audience: "爱吃辣的 食肉人士",
          price: 30.9,
          ingredient: "猪肉 蒜苗",
          pic: "./hui.jpeg",
        },
        {
          name: "牛肉面",
          detail: "牛肉面牛肉面",
          quantity: 0,
          audience: "面食者 食肉人士",
          price: 15.5,
          ingredient: "面 牛肉",
          pic: "./niu.jpg",
        },
        {
          name: "炒饭",
          detail: "炒饭炒饭",
          quantity: 0,
          price: 18.9,
          ingredient: "大米 鸡蛋",
          pic: "./chao.jpg",
        },
        {
          name: "红烧肉",
          detail:
            "其以五花肉为制作主料，最好选用肥瘦相间的三层肉（五花肉）来做，锅具以砂锅为主，做出来的肉肥瘦相间，香甜松软，营养丰富，入口即化。",
          quantity: 0,
          audience: "食肉人士",
          price: 19.9,
          ingredient: "猪肉",
          pic: "./hong.jpg",
        },
        {
          name: "回锅肉",
          detail:
            "是一种四川传统菜式中家常（味型）菜肴的代表菜肴之一，属于川菜系列。制作原料主要有猪后臀肉、青椒、蒜苗等，口味独特，色泽红亮，肥而不腻。",
          quantity: 0,
          audience: "爱吃辣的 食肉人士",
          price: 30.9,
          ingredient: "猪肉 蒜苗",
          pic: "./hui.jpeg",
        },
        {
          name: "牛肉面",
          detail: "牛肉面牛肉面",
          quantity: 0,
          audience: "面食者 食肉人士",
          price: 15.5,
          ingredient: "面 牛肉",
          pic: "./niu.jpg",
        },
        {
          name: "炒饭",
          detail: "炒饭炒饭",
          quantity: 0,
          price: 18.9,
          ingredient: "大米 鸡蛋",
          pic: "./chao.jpg",
        },
      ],
      foodDetail: {},
    };
  },
  methods: {
    showDetail(index) {
      this.showPopup = true;
      this.foodDetail = this.foodList[index];
    },
    sum() {
      let sum = 0;
      let price = 0;
      for (let i = 0; i < this.foodList.length; i++) {
        sum += this.foodList[i].quantity;
        price += this.foodList[i].quantity * this.foodList[i].price;
      }
      this.foodSum = sum;
      this.priceSum = price.toFixed(1);
    },
  },
};
</script>
